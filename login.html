<head>
  <title>Login</title>
  <link rel="stylesheet" type="text/css" href="login.css">
</head>

<body>
  <div class="main_img">
    <img class="main_logo"
      src="https://www.cookierun-kingdom.com/static/decf6a8e88828281281f56b219dc0940/991d2/logo-ko.webp" alt="메뉴"
      class="nav-logo sp_display">
    <br>
  </div>
  <div class="container">
    <h2>Login</h2>
    <form id="loginForm">
      <div class="form-group">
        <input type="text" id="username" name="username" placeholder="아이디">
      </div>
      <div class="form-group">
        <input type="password" id="password" name="password" placeholder="비밀번호">
      </div>
      <div class="form-group">
        <button type="submit">로그인</button>
      </div>
    </form>
  </div>

 
  <script>
     async function login() {
    const username = document.getElementById("username").value;
    const password = document.getElementById("password").value;

    // 실제 로그인 처리를 서버에 요청
    const response = await fetch('/login', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
      },
      body: `username=${username}&password=${password}`
    });

    if (response.redirected) {
      // 로그인이 성공하면 서버에서 리다이렉트된 페이지로 이동
      window.location.href = response.url;
    } else {
      // 로그인이 실패하면 경고 메시지 출력
      alert("아이디 또는 비밀번호가 일치하지 않습니다.");
    }
  }

  async function updateUIOnLogin() {
    // 서버에서 사용자 정보 가져오기
    const response = await fetch('/userinfo');
    const userInfo = await response.json();

    if (!userInfo.error) {
      // 로그인 후 화면 변경
      const loginLinks = document.querySelector(".link_item");
      const myPageLink = document.getElementById("myPageLink");
      const userId = document.getElementById("userId");

      loginLinks.style.display = "none"; // 로그인 전 메뉴 감춤
      myPageLink.style.display = "block"; // 로그인 후 내 정보 링크 보임
      userId.style.display = "block"; // 유저 아이디 보임
      userId.textContent = "회원 아이디: " + userInfo.userId;
    }
  }

  window.addEventListener('load', updateUIOnLogin);
</script>
</body>


</html>